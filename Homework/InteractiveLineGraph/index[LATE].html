<!DOCTYPE HTML>

<html>
	<head>
		<title> Plotje </title>
		<style>
		body {
    		font-family:verdana;

			}
		textarea {
			visibility: hidden;
		}
		canvas {
			position: absolute;
			left: 50%;
			transform: translateX(-50%);
		}
		canvas#mycanvas {
			padding-bottom: 50px;
			position: absolute;

		}
		canvas#crosshair{
			/*background: rgba(255,0,0,0.5);*/
			/*position: relative;*/
		}
		.label {
			position: absolute;
		}
		#temperature-label {
			left: 500px;
		}
		#date-label {
			transform: rotate(90deg);
			top: 500px;

		}

		p {
			font-size: 10px;
			text-align: center;
		}
		</style>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	</head>
	<body>
		<div align="center" id="container">
			<h1> Temperature The Netherlands 2014 </h1>
			<canvas id="mycanvas" height="500" width="750"></canvas>
			<canvas id="crosshair" height="500" width="750"></canvas>
			<div class='label' id="temperature-label"></div>
			<div class='label' id="date-label"></div>

		</div>
		<div>
			<textarea id="rawdata">
			[{"date": "2014/01/01", "temp": 99}, {"date": "2014/01/02", "temp": 103}, {"date": "2014/01/03", "temp": 122}, {"date": "2014/01/04", "temp": 93}, {"date": "2014/01/05", "temp": 84}, {"date": "2014/01/06", "temp": 145}, {"date": "2014/01/07", "temp": 123}, {"date": "2014/01/08", "temp": 100}, {"date": "2014/01/09", "temp": 121}, {"date": "2014/01/10", "temp": 88}, {"date": "2014/01/11", "temp": 78}, {"date": "2014/01/12", "temp": 62}, {"date": "2014/01/13", "temp": 99}, {"date": "2014/01/14", "temp": 71}, {"date": "2014/01/15", "temp": 64}, {"date": "2014/01/16", "temp": 89}, {"date": "2014/01/17", "temp": 90}, {"date": "2014/01/18", "temp": 86}, {"date": "2014/01/19", "temp": 71}, {"date": "2014/01/20", "temp": 60}, {"date": "2014/01/21", "temp": 54}, {"date": "2014/01/22", "temp": 43}, {"date": "2014/01/23", "temp": 52}, {"date": "2014/01/24", "temp": 67}, {"date": "2014/01/25", "temp": 63}, {"date": "2014/01/26", "temp": 68}, {"date": "2014/01/27", "temp": 62}, {"date": "2014/01/28", "temp": 68}, {"date": "2014/01/29", "temp": 25}, {"date": "2014/01/30", "temp": 50}, {"date": "2014/01/31", "temp": 74}, {"date": "2014/02/01", "temp": 84}, {"date": "2014/02/02", "temp": 80}, {"date": "2014/02/03", "temp": 82}, {"date": "2014/02/04", "temp": 94}, {"date": "2014/02/05", "temp": 104}, {"date": "2014/02/06", "temp": 96}, {"date": "2014/02/07", "temp": 103}, {"date": "2014/02/08", "temp": 90}, {"date": "2014/02/09", "temp": 76}, {"date": "2014/02/10", "temp": 90}, {"date": "2014/02/11", "temp": 83}, {"date": "2014/02/12", "temp": 91}, {"date": "2014/02/13", "temp": 69}, {"date": "2014/02/14", "temp": 88}, {"date": "2014/02/15", "temp": 134}, {"date": "2014/02/16", "temp": 94}, {"date": "2014/02/17", "temp": 104}, {"date": "2014/02/18", "temp": 80}, {"date": "2014/02/19", "temp": 110}, {"date": "2014/02/20", "temp": 100}, {"date": "2014/02/21", "temp": 103}, {"date": "2014/02/22", "temp": 103}, {"date": "2014/02/23", "temp": 118}, {"date": "2014/02/24", "temp": 126}, {"date": "2014/02/25", "temp": 126}, {"date": "2014/02/26", "temp": 111}, {"date": "2014/02/27", "temp": 78}, {"date": "2014/02/28", "temp": 85}, {"date": "2014/03/01", "temp": 82}, {"date": "2014/03/02", "temp": 98}, {"date": "2014/03/03", "temp": 99}, {"date": "2014/03/04", "temp": 107}, {"date": "2014/03/05", "temp": 126}, {"date": "2014/03/06", "temp": 137}, {"date": "2014/03/07", "temp": 128}, {"date": "2014/03/08", "temp": 160}, {"date": "2014/03/09", "temp": 195}, {"date": "2014/03/10", "temp": 180}, {"date": "2014/03/11", "temp": 144}, {"date": "2014/03/12", "temp": 168}, {"date": "2014/03/13", "temp": 168}, {"date": "2014/03/14", "temp": 120}, {"date": "2014/03/15", "temp": 118}, {"date": "2014/03/16", "temp": 122}, {"date": "2014/03/17", "temp": 120}, {"date": "2014/03/18", "temp": 105}, {"date": "2014/03/19", "temp": 159}, {"date": "2014/03/20", "temp": 212}, {"date": "2014/03/21", "temp": 110}, {"date": "2014/03/22", "temp": 105}, {"date": "2014/03/23", "temp": 95}, {"date": "2014/03/24", "temp": 109}, {"date": "2014/03/25", "temp": 108}, {"date": "2014/03/26", "temp": 96}, {"date": "2014/03/27", "temp": 137}, {"date": "2014/03/28", "temp": 173}, {"date": "2014/03/29", "temp": 192}, {"date": "2014/03/30", "temp": 202}, {"date": "2014/03/31", "temp": 204}, {"date": "2014/04/01", "temp": 204}, {"date": "2014/04/02", "temp": 215}, {"date": "2014/04/03", "temp": 227}, {"date": "2014/04/04", "temp": 152}, {"date": "2014/04/05", "temp": 177}, {"date": "2014/04/06", "temp": 177}, {"date": "2014/04/07", "temp": 212}, {"date": "2014/04/08", "temp": 138}, {"date": "2014/04/09", "temp": 148}, {"date": "2014/04/10", "temp": 154}, {"date": "2014/04/11", "temp": 153}, {"date": "2014/04/12", "temp": 158}, {"date": "2014/04/13", "temp": 131}, {"date": "2014/04/14", "temp": 117}, {"date": "2014/04/15", "temp": 107}, {"date": "2014/04/16", "temp": 143}, {"date": "2014/04/17", "temp": 176}, {"date": "2014/04/18", "temp": 121}, {"date": "2014/04/19", "temp": 166}, {"date": "2014/04/20", "temp": 207}, {"date": "2014/04/21", "temp": 158}, {"date": "2014/04/22", "temp": 190}, {"date": "2014/04/23", "temp": 211}, {"date": "2014/04/24", "temp": 205}, {"date": "2014/04/25", "temp": 237}, {"date": "2014/04/26", "temp": 176}, {"date": "2014/04/27", "temp": 153}, {"date": "2014/04/28", "temp": 169}, {"date": "2014/04/29", "temp": 175}, {"date": "2014/04/30", "temp": 179}, {"date": "2014/05/01", "temp": 183}, {"date": "2014/05/02", "temp": 122}, {"date": "2014/05/03", "temp": 137}, {"date": "2014/05/04", "temp": 137}, {"date": "2014/05/05", "temp": 184}, {"date": "2014/05/06", "temp": 178}, {"date": "2014/05/07", "temp": 162}, {"date": "2014/05/08", "temp": 134}, {"date": "2014/05/09", "temp": 161}, {"date": "2014/05/10", "temp": 156}, {"date": "2014/05/11", "temp": 117}, {"date": "2014/05/12", "temp": 146}, {"date": "2014/05/13", "temp": 150}, {"date": "2014/05/14", "temp": 139}, {"date": "2014/05/15", "temp": 150}, {"date": "2014/05/16", "temp": 183}, {"date": "2014/05/17", "temp": 207}, {"date": "2014/05/18", "temp": 231}, {"date": "2014/05/19", "temp": 243}, {"date": "2014/05/20", "temp": 271}, {"date": "2014/05/21", "temp": 215}, {"date": "2014/05/22", "temp": 230}, {"date": "2014/05/23", "temp": 207}, {"date": "2014/05/24", "temp": 196}, {"date": "2014/05/25", "temp": 213}, {"date": "2014/05/26", "temp": 223}, {"date": "2014/05/27", "temp": 174}, {"date": "2014/05/28", "temp": 146}, {"date": "2014/05/29", "temp": 118}, {"date": "2014/05/30", "temp": 169}, {"date": "2014/05/31", "temp": 194}, {"date": "2014/06/01", "temp": 187}, {"date": "2014/06/02", "temp": 206}, {"date": "2014/06/03", "temp": 210}, {"date": "2014/06/04", "temp": 178}, {"date": "2014/06/05", "temp": 178}, {"date": "2014/06/06", "temp": 229}, {"date": "2014/06/07", "temp": 276}, {"date": "2014/06/08", "temp": 248}, {"date": "2014/06/09", "temp": 271}, {"date": "2014/06/10", "temp": 258}, {"date": "2014/06/11", "temp": 219}, {"date": "2014/06/12", "temp": 229}, {"date": "2014/06/13", "temp": 222}, {"date": "2014/06/14", "temp": 189}, {"date": "2014/06/15", "temp": 201}, {"date": "2014/06/16", "temp": 178}, {"date": "2014/06/17", "temp": 193}, {"date": "2014/06/18", "temp": 200}, {"date": "2014/06/19", "temp": 161}, {"date": "2014/06/20", "temp": 180}, {"date": "2014/06/21", "temp": 209}, {"date": "2014/06/22", "temp": 206}, {"date": "2014/06/23", "temp": 213}, {"date": "2014/06/24", "temp": 213}, {"date": "2014/06/25", "temp": 192}, {"date": "2014/06/26", "temp": 222}, {"date": "2014/06/27", "temp": 215}, {"date": "2014/06/28", "temp": 210}, {"date": "2014/06/29", "temp": 192}, {"date": "2014/06/30", "temp": 186}, {"date": "2014/07/01", "temp": 193}, {"date": "2014/07/02", "temp": 209}, {"date": "2014/07/03", "temp": 262}, {"date": "2014/07/04", "temp": 289}, {"date": "2014/07/05", "temp": 228}, {"date": "2014/07/06", "temp": 244}, {"date": "2014/07/07", "temp": 235}, {"date": "2014/07/08", "temp": 170}, {"date": "2014/07/09", "temp": 178}, {"date": "2014/07/10", "temp": 276}, {"date": "2014/07/11", "temp": 238}, {"date": "2014/07/12", "temp": 245}, {"date": "2014/07/13", "temp": 231}, {"date": "2014/07/14", "temp": 227}, {"date": "2014/07/15", "temp": 224}, {"date": "2014/07/16", "temp": 258}, {"date": "2014/07/17", "temp": 283}, {"date": "2014/07/18", "temp": 311}, {"date": "2014/07/19", "temp": 329}, {"date": "2014/07/20", "temp": 272}, {"date": "2014/07/21", "temp": 212}, {"date": "2014/07/22", "temp": 272}, {"date": "2014/07/23", "temp": 284}, {"date": "2014/07/24", "temp": 263}, {"date": "2014/07/25", "temp": 221}, {"date": "2014/07/26", "temp": 251}, {"date": "2014/07/27", "temp": 262}, {"date": "2014/07/28", "temp": 235}, {"date": "2014/07/29", "temp": 259}, {"date": "2014/07/30", "temp": 235}, {"date": "2014/07/31", "temp": 244}, {"date": "2014/08/01", "temp": 259}, {"date": "2014/08/02", "temp": 276}, {"date": "2014/08/03", "temp": 253}, {"date": "2014/08/04", "temp": 233}, {"date": "2014/08/05", "temp": 243}, {"date": "2014/08/06", "temp": 213}, {"date": "2014/08/07", "temp": 230}, {"date": "2014/08/08", "temp": 223}, {"date": "2014/08/09", "temp": 231}, {"date": "2014/08/10", "temp": 225}, {"date": "2014/08/11", "temp": 207}, {"date": "2014/08/12", "temp": 202}, {"date": "2014/08/13", "temp": 217}, {"date": "2014/08/14", "temp": 203}, {"date": "2014/08/15", "temp": 197}, {"date": "2014/08/16", "temp": 187}, {"date": "2014/08/17", "temp": 167}, {"date": "2014/08/18", "temp": 173}, {"date": "2014/08/19", "temp": 159}, {"date": "2014/08/20", "temp": 178}, {"date": "2014/08/21", "temp": 182}, {"date": "2014/08/22", "temp": 171}, {"date": "2014/08/23", "temp": 174}, {"date": "2014/08/24", "temp": 177}, {"date": "2014/08/25", "temp": 169}, {"date": "2014/08/26", "temp": 165}, {"date": "2014/08/27", "temp": 207}, {"date": "2014/08/28", "temp": 214}, {"date": "2014/08/29", "temp": 212}, {"date": "2014/08/30", "temp": 186}, {"date": "2014/08/31", "temp": 190}, {"date": "2014/09/01", "temp": 212}, {"date": "2014/09/02", "temp": 212}, {"date": "2014/09/03", "temp": 212}, {"date": "2014/09/04", "temp": 235}, {"date": "2014/09/05", "temp": 228}, {"date": "2014/09/06", "temp": 205}, {"date": "2014/09/07", "temp": 216}, {"date": "2014/09/08", "temp": 205}, {"date": "2014/09/09", "temp": 178}, {"date": "2014/09/10", "temp": 184}, {"date": "2014/09/11", "temp": 204}, {"date": "2014/09/12", "temp": 216}, {"date": "2014/09/13", "temp": 211}, {"date": "2014/09/14", "temp": 209}, {"date": "2014/09/15", "temp": 228}, {"date": "2014/09/16", "temp": 246}, {"date": "2014/09/17", "temp": 252}, {"date": "2014/09/18", "temp": 253}, {"date": "2014/09/19", "temp": 244}, {"date": "2014/09/20", "temp": 240}, {"date": "2014/09/21", "temp": 192}, {"date": "2014/09/22", "temp": 175}, {"date": "2014/09/23", "temp": 177}, {"date": "2014/09/24", "temp": 165}, {"date": "2014/09/25", "temp": 178}, {"date": "2014/09/26", "temp": 194}, {"date": "2014/09/27", "temp": 202}, {"date": "2014/09/28", "temp": 220}, {"date": "2014/09/29", "temp": 193}, {"date": "2014/09/30", "temp": 209}, {"date": "2014/10/01", "temp": 207}, {"date": "2014/10/02", "temp": 192}, {"date": "2014/10/03", "temp": 222}, {"date": "2014/10/04", "temp": 211}, {"date": "2014/10/05", "temp": 152}, {"date": "2014/10/06", "temp": 161}, {"date": "2014/10/07", "temp": 156}, {"date": "2014/10/08", "temp": 166}, {"date": "2014/10/09", "temp": 180}, {"date": "2014/10/10", "temp": 178}, {"date": "2014/10/11", "temp": 157}, {"date": "2014/10/12", "temp": 162}, {"date": "2014/10/13", "temp": 185}, {"date": "2014/10/14", "temp": 136}, {"date": "2014/10/15", "temp": 184}, {"date": "2014/10/16", "temp": 180}, {"date": "2014/10/17", "temp": 188}, {"date": "2014/10/18", "temp": 230}, {"date": "2014/10/19", "temp": 215}, {"date": "2014/10/20", "temp": 177}, {"date": "2014/10/21", "temp": 140}, {"date": "2014/10/22", "temp": 135}, {"date": "2014/10/23", "temp": 151}, {"date": "2014/10/24", "temp": 126}, {"date": "2014/10/25", "temp": 153}, {"date": "2014/10/26", "temp": 159}, {"date": "2014/10/27", "temp": 170}, {"date": "2014/10/28", "temp": 140}, {"date": "2014/10/29", "temp": 128}, {"date": "2014/10/30", "temp": 156}, {"date": "2014/10/31", "temp": 166}, {"date": "2014/11/01", "temp": 185}, {"date": "2014/11/02", "temp": 174}, {"date": "2014/11/03", "temp": 153}, {"date": "2014/11/04", "temp": 109}, {"date": "2014/11/05", "temp": 95}, {"date": "2014/11/06", "temp": 82}, {"date": "2014/11/07", "temp": 98}, {"date": "2014/11/08", "temp": 129}, {"date": "2014/11/09", "temp": 128}, {"date": "2014/11/10", "temp": 126}, {"date": "2014/11/11", "temp": 129}, {"date": "2014/11/12", "temp": 122}, {"date": "2014/11/13", "temp": 133}, {"date": "2014/11/14", "temp": 124}, {"date": "2014/11/15", "temp": 110}, {"date": "2014/11/16", "temp": 92}, {"date": "2014/11/17", "temp": 123}, {"date": "2014/11/18", "temp": 83}, {"date": "2014/11/19", "temp": 91}, {"date": "2014/11/20", "temp": 80}, {"date": "2014/11/21", "temp": 90}, {"date": "2014/11/22", "temp": 118}, {"date": "2014/11/23", "temp": 135}, {"date": "2014/11/24", "temp": 113}, {"date": "2014/11/25", "temp": 91}, {"date": "2014/11/26", "temp": 64}, {"date": "2014/11/27", "temp": 88}, {"date": "2014/11/28", "temp": 95}, {"date": "2014/11/29", "temp": 49}, {"date": "2014/11/30", "temp": 31}, {"date": "2014/12/01", "temp": 24}, {"date": "2014/12/02", "temp": 14}, {"date": "2014/12/03", "temp": 10}, {"date": "2014/12/04", "temp": 15}, {"date": "2014/12/05", "temp": 53}, {"date": "2014/12/06", "temp": 91}, {"date": "2014/12/07", "temp": 67}, {"date": "2014/12/08", "temp": 49}, {"date": "2014/12/09", "temp": 49}, {"date": "2014/12/10", "temp": 99}, {"date": "2014/12/11", "temp": 77}, {"date": "2014/12/12", "temp": 94}, {"date": "2014/12/13", "temp": 68}, {"date": "2014/12/14", "temp": 48}, {"date": "2014/12/15", "temp": 79}, {"date": "2014/12/16", "temp": 78}, {"date": "2014/12/17", "temp": 106}, {"date": "2014/12/18", "temp": 125}, {"date": "2014/12/19", "temp": 124}, {"date": "2014/12/20", "temp": 91}, {"date": "2014/12/21", "temp": 103}, {"date": "2014/12/22", "temp": 128}, {"date": "2014/12/23", "temp": 128}, {"date": "2014/12/24", "temp": 100}, {"date": "2014/12/25", "temp": 79}, {"date": "2014/12/26", "temp": 52}, {"date": "2014/12/27", "temp": 29}, {"date": "2014/12/28", "temp": 34}, {"date": "2014/12/29", "temp": 56}, {"date": "2014/12/30", "temp": 65}, {"date": "2014/12/31", "temp": 76}]

			</textarea>
		</div>

		<!-- <p>Yaleesa BÃŸorgman 6215262</p> -->

		<script>
			var rawdata = {
				date : '',
				maxtemp: 0
			}

			//fucntion for getting the data and putting them in the graph
			function dataPoints(dataSet) {
				ctx.beginPath();
				ctx.moveTo(0, dataSet[0].temp);

				for (i=1;i<dataArray.length;i++) {
					ctx.lineTo(i * xScale, dataSet[i].temp);
				}
				ctx.stroke();
			}

			function drawCrosshair (dataSet) {
				//crosshair canvas
				var crosshair = document.getElementById('crosshair');
				// var ch = crosshair.getContext('2d');
				var chDim = crosshair.getBoundingClientRect()
				var xOffset = Math.round(chDim.left) + rowSize + 3
				crosshair.addEventListener("mousemove", function(e){
					xPos = e.clientX - xOffset
					yPos = e.clientY - Math.round(chDim.top)
					var index = Math.round(xPos / xScale)
					if (index < 0 ){
						index = 0
					}

					yPos = dataSet[index].temp
					updateCanvas(index, yPos)
				})
			}

			function updateCanvas (index, temp) {
				resetCanvas()
				var crosshair = document.getElementById('crosshair');
				var ch = crosshair.getContext('2d');
				var chDim = crosshair.getBoundingClientRect()

				var xPos = index * xScale
				var yPos = (dataArray[index].temp - (canvas.height + 2 * Val_min * yScale))* -1 * yScale + 3

				ch.moveTo(xPos + rowSize + 3, 0)
				ch.lineTo(xPos + rowSize +3, crosshair.height)
				ch.moveTo(0, yPos)
				ch.lineTo(crosshair.width, yPos)
				ch.stroke()

				var tempLab = document.getElementById('temperature-label')
				var datLab = document.getElementById('date-label')
				tempLab.setAttribute("style", "top:" + (yPos + chDim.top) + "px;")
				tempLab.innerHTML = temp
				datLab.setAttribute("style", "left:"+(xPos + chDim.left + 5) + "px;")
				datLab.innerHTML = dataArray[index].date


			}

			function resetCanvas () {
				document.getElementById('crosshair').remove()
				var container = document.getElementById('container')
				var newCross = document.createElement('canvas')
				newCross.setAttribute("id", "crosshair")
				newCross.setAttribute("height", 500)
				newCross.setAttribute("width", 750)
				container.appendChild(newCross)
				drawCrosshair(dataArray)
			}

			var	dataString = document.getElementById("rawdata").textContent;
			var dataArray= JSON.parse(dataString)
			// var lines = myNodelist.split("\n")
			// for (var i = 1 ; i<lines.length; i++) {
			// 	var arr = lines[i].split(",");
			// 	dataArray.push([new Date(arr[0]),arr[1]])
			// }

			//begin with the graph
			//first the needed variables
			var sections = 366;
			var Val_max = 350;
			var Val_min = -50;
			var stepSize = 50;
			var columnSize = 50;
			var rowSize = 40;
			var margin = 15;
			var xAxis = [" ", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"] 

			//getting the canvas tag and convert it into a 2D rendering context
			var canvas = document.getElementById('mycanvas');
			var ctx = canvas.getContext('2d');
			ctx.fillStyle = "#0099ff"
			ctx.font = "22 pt Verdana"

			


			//making x and y scale, and a different one for the months
			yScale = (canvas.height - columnSize - margin) / (Val_max - Val_min);
			xScale = (canvas.width - rowSize) / sections;
			monthScale = (canvas.width + rowSize) / xAxis.length -1 ;

			ctx.beginPath();

			ctx.moveTo(rowSize + 3, columnSize);
			ctx.lineTo(rowSize + 3, canvas.height - margin);

			//making x axis (and the vertical lines)
			for (i=1;i<=xAxis.length;i++) {
				var x = (i * monthScale) - margin - 3;
				ctx.fillText(xAxis[i], x + margin, canvas.height -2 );
				
				}
			//making y axis
			var count =  0;
			for (scale=Val_max;scale>=Val_min;scale = scale - stepSize) {
		      	var y = columnSize + (yScale * count * stepSize); 
		      	ctx.fillText(scale, margin,y);
				count++;
				}

			ctx.stroke();

			

			//getting the lines right in the graph
			ctx.translate(rowSize + 3, canvas.height + Val_min * yScale -margin);
	  		ctx.scale(1,-1 * yScale);

	  	

			dataPoints(dataArray)
			drawCrosshair(dataArray)

		</script>
	</body>

</html>